{% extends "library/layout.html" %}
{% load static %}
{% block body %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-auto">
            <img class="card-img-top book-cover mx-auto" src="{{book.cover}}" alt="book cover">
            <div class="d-flex flex-column justify-content-center align-items-center">
            <div class="star-outer mt-2">
                <div class="star-inner"></div>
            </div>
            <p>4.2 (21 Reviews) </p>
        </div>
        </div>
        <div class="col-8 border-start border-2">
            <div class="px-3">
                <h2 class="book-title">{{book.title}}</h2>
                <h5>by {{book.author}}</h5>
                <div class="book-desc">
                    <p class="mb-0 collapse" id="collapse-desc">{{book.description}}</p>
                </div>
                <button class="show-more btn btn-primary" data-bs-toggle="collapse" href="#collapse-desc" 
                aria-expanded="false" aria-controls="collapse-desc"><i class="bi bi-caret-down-fill"></i> Read more  <i class="bi bi-caret-down-fill"></i></button>
                <p><span class="text-decoration-underline">Publisher:</span> {{book.publisher}} | <span class="text-decoration-underline">Publish Date:</span> {{book.pub_date}}</p>
                <div class="mb-2 overflow-auto">
                <p class="text-nowrap"><span class="text-decoration-underline">Genres:</span>
                {% for genre in book.genres.all %}
                <span class="mx-2 fw-bolder">{{genre.name}}</span>
                {% empty %}
                    <span>no genre</span>
                {% endfor %}
                </p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container mt-4" style="max-width: 1000px;">
    <div class="row ms-5">
    <h2 class="ms">Reviews</h2>
    </div>
    {% if reviews %}
        {% for review in reviews %}
        <div class="row ms-5">
            <div class="card mb-3 clickme border">
                <div class="row flex-nowrap">
                <div class="col-md-2 d-flex flex-column justify-content-center align-items-center ">
                    <img class="m-auto" src="{% static 'library/images/person.svg' %}" alt="profile" style="max-width:80px;">
                    <p class="mx-auto oneliner">{{review.user_id.username}}</p>
                </div>
                <div class="col-md-9">
                    <div class="card-body">
                    <h5 class="card-title">
                        <div class="star-outer">
                        <div class="star-inner"></div>
                    </div></h5>
                    <p class="card-text">{{review.text}}</p>
                    <p class="card-text"><small class="text-muted">Review on {{review.date}}</small><button type="button" class="btn btn-primary ms-3" data-bs-toggle="modal" data-bs-target="#exampleModal" data-bs-whatever="@mdo">Read Review</button></p>
                    </div>
                </div>
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
    <h3 class="text-center mt-3">No reviews yet.</h3>
    {% endif %}
</div>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg model-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
            <img class="mx-3" src="{% static 'library/images/person.svg' %}" alt="profile" style="max-width:40px;">
            <h3 class="modal-title fs-5" id="exampleModalLabel">Commander Kenan's Review</h3>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="text-center mb-2">
            <div class="star-outer">
                <div class="star-inner"></div></div></div>
            <p id="review-text"></p>
        </div>
      </div>
    </div>
</div>


{% endblock %}